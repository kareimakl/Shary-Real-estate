<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8" />
  <title>مشاريع في مصر مع مناطق ملونة وخريطة قمر صناعي عند زوم</title>
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <script src="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.js"></script>
  <link
    href="https://api.mapbox.com/mapbox-gl-js/v2.14.1/mapbox-gl.css"
    rel="stylesheet"
  />
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Shary</title>

  <script src="https://cdn.tailwindcss.com"></script>
  <!-- Swiper CSS -->
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css"
  />
  <link
    rel="stylesheet"
    href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
  />
      <meta charset="UTF-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico" />
    <title>Shary</title>

    <script src="https://cdn.tailwindcss.com"></script>
    <script src="/js/navbar.js"></script>
    <script src="/components/footer.js" type="text/javascript" defer></script>
    <script src="/js/language.js"></script>
    <script src="/js/main.js"></script>
    <!-- Swiper CSS -->
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@10/swiper-bundle.min.css"
    />
    <link rel="stylesheet" href="/styles/main.css" />
    <link
      rel="stylesheet"
      href="https://cdn.jsdelivr.net/npm/swiper@11/swiper-bundle.min.css"
    />
<style>
  body {
    margin: 0;
    padding: 0;
    font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
  }

  #map {
    position: absolute;
    top: 0;
    bottom: 0;
    width: 100%;
  }
 .search-results {
    position: absolute;
    background: white;
    border: 1px solid #ccc;
    width: 250px;
    max-height: 300px;
    overflow-y: auto;
    z-index: 9999;
  }
  .search-result-item {
    padding: 8px;
    border-bottom: 1px solid #eee;
    display: flex;
    align-items: center;
    gap: 10px;
    cursor: pointer;
  }
  .search-result-item img {
    width: 30px;
    height: 30px;
    object-fit: contain;
  }
  .hidden {
    display: none;
  }
  .marker-label {
    font-weight: bold;
    font-size: 10px;
    background-color: #ffffff;
    padding: 2px 6px;
    border-radius: 107.69px;
    color: #000000;
    max-width: 80px;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    transform: translate(-50%, -50%);
    font-family: Arial, sans-serif;
    box-shadow: 0 2px 6px rgba(0, 0, 0, 0.15);
  }

  .search-bar {
    position: absolute;
    top: 20px;
    left: 55%;
    transform: translateX(-50%);
    z-index: 10;
    padding: 10px;
    width: 100%;
    overflow-x: auto;
    height: auto !important;

  }

  .search-container {
    display: flex;
    flex-wrap: nowrap;
    gap: 10px;
    align-items: center;
    width: max-content;
    min-width: 100%;
  }

  .search-container::-webkit-scrollbar {
    display: none; /* إخفاء شريط التمرير */
  }

  .bg-filter-box {
    display: flex;
    align-items: center;
    padding: 6px 10px;
    border-radius: 107.69px;
    width: 289px;
    height: 50px;
    background: white;
    flex-shrink: 0;
    gap:8.62px;
  }

  .search-input {
    flex: 1;
    min-width: 180px;
    padding: 8px 15px;
    border: 1px solid #e0e0e0;
    border-radius: 6px;
    font-size: 14px;
    outline: none;
    transition: border 0.3s;
  }

  .search-input:focus {
    border-color: #1D4265;
  }

  .filter-btn, .reset-btn {
    white-space: nowrap;
    flex-shrink: 0;
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 15px;
    font-size: 14px;
    border-radius: 107.69px;
    cursor: pointer;
    transition: all 0.3s;
  }

  .filter-btn {
    background: #fff;
    border: 1px solid #e0e0e0;
    height: 49.8px;
    width: 181px;
    justify-content: center;
  }

  .filter-btn:hover {
    background: #e9e9e9;
  }

  .reset-btn {
    background: #fff;
    color: #1D4265;
    border: none;
  }

  .filter-section {
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
    margin-top: 10px;
    padding-top: 10px;
    border-top: 1px solid #f0f0f0;
  }

  .filter-label {
    font-size: 12px;
    color: #666;
    margin-bottom: 5px;
    text-align: center;
  }

  .filter-control {
    display: flex;
    flex-direction: column;
    align-items: center;
    min-width: 100px;
  }

  .filter-select {
    width: 100%;
    padding: 5px;
    border: 1px solid #e0e0e0;
    border-radius: 4px;
    font-size: 13px;
  }

  @media (max-width: 768px) {
    .search-container {
      flex-wrap: nowrap;
      overflow-x: auto;
      padding-bottom: 10px;
    }
  .search-bar {
    top: 0px;
    left: 50%;
    height: auto !important;
  }

    .search-container::-webkit-scrollbar {
      height: 6px;
    }

    .search-container::-webkit-scrollbar-thumb {
      background-color: #ccc;
      border-radius: 3px;
    } 
    .filter-btn {
    height: 32px;
    width: 140px;
  }

  }
</style>

</head>
<body>
  <div id="map">
<div class="search-bar">
  <div class="search-container flex md:flex-row flex-col items-start justify-start  flex-nowrap ">
    <div class="filter-btn-box items-start md:block flex gap-1 justify-start left-2  translate-y-0 ">
  <!-- مربع البحث -->
      <button class="filter-btn md:hidden flex  m-auto w-[50px] h-[51px]">
      <img src="./icons/Vector copy 2.svg" alt="" class="w-6 h-6  m-auto" />
    </button>
    <div class="bg-filter-box ">
      <img src="./icons/search.svg" alt="" class="w-4 h-4 ml-2" />
      <input 
        type="text" 
        class="search-input border-none" 
        placeholder="Search By Area, Compound, Developer"
      />

    </div>
    <!-- زر الريسيت -->
    <button class="reset-btn md:flex hidden mt-2 h-[29px]">
      Reset View
    </button>
    </div>
  
<div class="overflow-x-auto md:gap-4  gap-1 w-full flex flex-nowrap">


    <!-- الفلاتر -->
    <button class="filter-btn"
    onclick="priceFilter('open')">
      <img src="./icons/Search copy.svg" alt="" class="w-6 h-6" />
      Price Range
    </button>

    <button class="filter-btn"
          onclick="propertyFilter('open')">
      <img src="./icons/Search copy 2.svg" alt="" class="w-6 h-6" />
      Property Types
    </button>
    <button class="filter-btn"
      onclick="deliveryFilter('open')">
      <img src="./icons/Search copy 3.svg" alt="" class="w-6 h-6" />
      Delivery
    </button>

    <button class="filter-btn"
        onclick="toggleFilterBar('open')">
      <img src="./icons/weui_more-filled.svg" alt="" class="w-6 h-6" />
      More Filters
    </button>

</div>
  </div>
</div>

      </div>
    </div>
  </div>
  
      <!-- Modal -->
      <div
        id="unitModal"
        class="fixed m-auto left-0 right-0 inset-0 bg-black bg-opacity-50 hidden items-center justify-center !z-50"
      >
        <div class="bg-white p-6 m-auto mt-16 rounded-lg shadow-lg w-full max-w-md relative">
          <button
            onclick="closeModal()"
            class="absolute top-2 right-2 text-gray-500 text-2xl"
          >
            &times;
          </button>

          <h2 class="text-xm font-semibold mb-2">Unit Details</h2>

          <a href="./inside-project.html">
            <img
              id="unitImage"
              src="./images/compound.jpeg"
              alt="Unit Image"
              class="w-full rounded mb-3"
            />
          </a>

          <div class="mt-4">
            <div class="pb-3 flex items-center justify-between">
              <div class="text-[#4DBFB1] sm:text-xs text-xs font-medium">
                <p>Total Price</p>
                <p
                  id="unitPrice"
                  class="mt-1 font-bold text-xm text-[#1D4265] manrope"
                >
                  11,312,000 EGP
                </p>
              </div>
              <div class="text-[#4DBFB1] sm:text-xs text-xs font-medium">
                <p>Down Payment</p>
                <p
                  id="unitLocation"
                  class="mt-1 font-bold text-xm text-[#1D4265] manrope"
                >
                  11,312,000 EGP
                </p>
              </div>
            </div>
          </div>
          <div class="pb-3 flex items-center justify-between">
            <div id="unitDate" class="text-xs text-gray-500 mb-2"></div>
            <div class="text-xs mb-2 flex items-center">
              <span id="unitCode" class=""></span>
              <a
                href="#"
                class="ml-2 bg-[#1D4265] text-white px-2 py-1 text-xs rounded"
                >PDF</a
              >
            </div>
          </div>

          <div class="grid grid-cols-2 gap-2 text-xs mb-2">
            <div class="flex gap-3 items-center">
              <div
                class="border border-solid border-[#E4E4E4] rounded-lg md:w-[52px] w-[42px] md:h-[52px] h-[42px] flex items-center justify-center"
              >
                <span
                  class="material-symbols-rounded text-[#1D4265] md:text-2xl text-xm"
                  >page_info</span
                >
              </div>
              <div>
                <p
                  id="unitType"
                  class="text-[#5C6368] md:text-xs text-xs font-normal"
                >
                  Type:
                </p>
                <p
                  class="text-[#1D4265] md:text-base text-xs font-bold leading-tight manrope"
                >
                  Villa
                </p>
              </div>
            </div>
            <div class="flex gap-3 items-center">
              <div
                class="border border-solid border-[#E4E4E4] rounded-lg md:w-[52px] w-[42px] md:h-[52px] h-[42px] flex items-center justify-center"
              >
                <span
                  class="material-symbols-rounded text-[#1D4265] md:text-2xl text-xm"
                  style="transform: rotate(-45deg)"
                  >straighten</span
                >
              </div>
              <div>
                <p class="text-[#5C6368] md:text-xs text-xs font-normal">
                  Apartment area:
                </p>
                <p
                  id="unitSize"
                  class="text-[#1D4265] md:text-base text-xs font-bold leading-tight manrope"
                >
                  900 SqFt
                </p>
              </div>
            </div>
            <div class="flex gap-3 items-center">
              <div
                class="border border-solid border-[#E4E4E4] rounded-lg md:w-[52px] w-[42px] md:h-[52px] h-[42px] flex items-center justify-center"
              >
                <span
                  class="material-symbols-rounded text-[#1D4265] md:text-2xl text-xm"
                  >bed</span
                >
              </div>
              <div>
                <p class="text-[#5C6368] md:text-xs text-xs font-normal">
                  Bedrooms:
                </p>
                <p
                  id="unitBedrooms"
                  class="text-[#1D4265] md:text-base text-xs font-bold leading-tight manrope"
                >
                  2 Rooms
                </p>
              </div>
            </div>
            <div class="flex gap-3 items-center">
              <div
                class="border border-solid border-[#E4E4E4] rounded-lg md:w-[52px] w-[42px] md:h-[52px] h-[42px] flex items-center justify-center"
              >
                <span
                  class="material-symbols-rounded text-[#1D4265] md:text-2xl text-xm"
                  >real_estate_agent</span
                >
              </div>
              <div>
                <p class="text-[#5C6368] md:text-xs text-xs font-normal">
                  Delivery In:
                </p>
                <p
                  id="unitDelivery"
                  class="text-[#1D4265] md:text-base text-xs font-bold leading-tight manrope"
                >
                  2023
                </p>
              </div>
            </div>
          </div>

          <div
            id="unitProject"
            class="text-xs text-blue-700 underline mb-1"
          ></div>

          <div
            class="w-full border-t border-1 border-solid border-[#1D4265] flex justify-center items-center m-auto text-center"
          >
            <div
              class="flex items-center justify-between m-auto gap-2 bg-[#FFFFFF3B] md:rounded-[36px] rounded-2xl sm:px-4 p-2"
            >
              <div
                style="box-shadow: 0px 0px 5px rgba(0, 0, 0, 0.53)"
                class="shrink-0 !w-16 p-2 justify-center border border-solid border-[#00000040] m-auto text-center flex item-center !h-16 rounded-full shadow-md"
              >
                <img
                  loading="lazy"
                  src="./images/lo.png"
                  class="sm:w-44 !w-12"
                  alt="KWVV"
                />
              </div>
              <div
                class="border-s border-1 border-solid border-[#1D4265] h-8"
              ></div>

              <div
                class="text-white font-light sm:text-xs text-xs sm:border-s border-solid border-white ps-2"
              >
                <p
                  id="unitDeveloper"
                  class="leading-tight text-[#1D4265] w-auto text-start"
                  data-i18n="ZED East New Cairo Compound is a prestigious project by Ora Developers."
                ></p>
              </div>
            </div>
          </div>
          <!-- <div id="unitDeveloper" class="text-xs text-yellow-600"></div> -->
        </div>
      </div>


      <!-- Fixed Filter -->
      <div
        id="filterBar"
        class=" bg-white md:max-w-[388px] fixed bottom-0 max-h-0 w-full z-40"
        style="transition: max-height 0.3s ease-in-out"
      >
        <div class="bg-white p-4 pt-16 relative">
          <button
            onclick="toggleFilterBar('close')"
            class="absolute bottom-2 bg-[#F5F5F5] rounded-full w-10 h-10 cursor-pointer flex items-center justify-center"
          >
            <span
              class="material-symbols-rounded font-normal text-xl leading-none text-[#1D1D1D]"
              data-i18n="keyboard_arrow_left"
            ></span>
          </button>
          <button
            id="searchBar_close"
            onclick="toggleSearchBar('close')"
            class="z-[-1] absolute bottom-2 bg-[#F5F5F5] rounded-full w-10 h-10 cursor-pointer flex items-center justify-center"
          >
            <span
              class="material-symbols-rounded font-normal text-xl leading-none text-[#1D1D1D]"
              data-i18n="keyboard_arrow_left"
            ></span>
          </button>
          <p class="text-[#1D4265] flex items-center justify-center gap-1.5">
            <span
              class="material-symbols-rounded text-xl flex leading-none h-[22px]"
              >tune</span
            >
            <span class="font-medium text-xl leading-none">Filter</span>
          </p>
        </div>
        <div class="overflow-y-auto h-full" style="height: calc(100% - 173px)">
          <div
            class="py-3 px-6 flex justify-center gap-3 manrope text-xs font-medium border-b border-[#D9D9D9]"
          >
            <div class="filter-input">
              <input
                checked
                type="radio"
                name="header filter"
                id="developerUnits"
              />
              <label
                class="block py-2 px-4 rounded-full border border-solid border-[#1D4265] bg-white text-[#1D4265]"
                for="developerUnits"
                >Developer Units</label
              >
            </div>
            <div class="filter-input">
              <input type="radio" name="header filter" id="resale" />
              <label
                class="block py-2 px-4 rounded-full border border-solid border-[#1D4265] bg-white text-[#1D4265]"
                for="resale"
                >Resale</label
              >
            </div>
          </div>

          <!-- Property Type -->
          <div class="py-4 px-6 font-medium border-b border-[#D9D9D9]">
            <div class="flex items-center justify-between">
              <p class="text-[#1D4265] text-[15px]">Property Type</p>
              <button class="text-[#1563DF] text-[10px]">Reset</button>
            </div>
            <div class="mt-3 manrope flex gap-x-2.5 gap-y-5 flex-wrap text-xs">
              <div class="filter-input">
                <input type="checkbox" name="apartment" id="apartment" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="apartment"
                  >Apartment</label
                >
              </div>
              <div class="filter-input">
                <input checked type="checkbox" name="villa" id="villa" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="villa"
                  >Villa</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="studio" id="studio" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="studio"
                  >Studio</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="duplex" id="duplex" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="duplex"
                  >Duplex</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="townhouse" id="townhouse" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="townhouse"
                  >Townhouse</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="twinhouse" id="twinhouse" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="twinhouse"
                  >Twinhouse</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="penthouse" id="penthouse" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="penthouse"
                  >Penthouse</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="chalet" id="chalet" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="chalet"
                  >Chalet</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="cabin" id="cabin" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="cabin"
                  >Cabin</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="clinic" id="clinic" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="clinic"
                  >Clinic</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="office" id="office" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="office"
                  >Office</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="retail" id="retail" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="retail"
                  >Retail</label
                >
              </div>
            </div>
          </div>

          <!-- Area & Developer -->
          <div class="py-4 px-6 border-b border-[#D9D9D9] font-medium">
            <div class="flex justify-end">
              <button class="text-[#1563DF] text-[10px]">Reset</button>
            </div>
            <div class="grid grid-cols-2 gap-10">
              <div>
                <p class="text-[#1D4265] text-[15px] leading-7">Area</p>
                <button
                  onclick="toggleSearchBar('open')"
                  class="manrope w-full text-xs p-2 text-center border border-solid border-[#92929226] bg-[#FAFAFA] rounded-full text-[#5990FF]"
                >
                  + Add
                </button>
              </div>
              <div>
                <p class="text-[#1D4265] text-[15px] leading-7">Developer</p>
                <button
                  onclick="toggleSearchBar('open')"
                  class="manrope w-full text-xs p-2 text-center border border-solid border-[#92929226] bg-[#FAFAFA] rounded-full text-[#5990FF]"
                >
                  + Add
                </button>
              </div>
            </div>
          </div>

          <!-- Bedrooms -->
          <div class="py-4 px-6 border-b border-[#D9D9D9] font-medium">
            <div class="flex items-center justify-between">
              <p class="text-[#1D4265] text-[15px]">Bedrooms</p>
              <button class="text-[#1563DF] text-[10px]">Reset</button>
            </div>
            <div class="mt-3 manrope flex gap-4 flex-wrap text-sm">
              <div class="filter-input">
                <input type="checkbox" name="bedroom1" id="bedroom1" />
                <label
                  class="rounded-xl w-8 h-8 flex items-center text-[#1D4265] justify-center bg-[#2972FF1A]"
                  for="bedroom1"
                  >1</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="bedroom2" id="bedroom2" />
                <label
                  class="rounded-xl w-8 h-8 flex items-center text-[#1D4265] justify-center bg-[#2972FF1A]"
                  for="bedroom2"
                  >2</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="bedroom3" id="bedroom3" />
                <label
                  class="rounded-xl w-8 h-8 flex items-center text-[#1D4265] justify-center bg-[#2972FF1A]"
                  for="bedroom3"
                  >3</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="bedroom4" id="bedroom4" />
                <label
                  class="rounded-xl w-8 h-8 flex items-center text-[#1D4265] justify-center bg-[#2972FF1A]"
                  for="bedroom4"
                  >4</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="bedroom+5" id="bedroom+5" />
                <label
                  class="rounded-xl w-8 h-8 flex items-center text-[#1D4265] justify-center bg-[#2972FF1A]"
                  for="bedroom+5"
                  >+5</label
                >
              </div>
            </div>
          </div>

          <!-- Bathrooms -->
          <div class="py-4 px-6 border-b border-[#D9D9D9] font-medium">
            <div class="flex items-center justify-between">
              <p class="text-[#1D4265] text-[15px]">Bathrooms</p>
              <button class="text-[#1563DF] text-[10px]">Reset</button>
            </div>
            <div class="mt-3 manrope flex gap-4 flex-wrap text-sm">
              <div class="filter-input">
                <input type="checkbox" name="bathrooms1" id="bathrooms1" />
                <label
                  class="rounded-xl w-8 h-8 flex items-center text-[#1D4265] justify-center bg-[#2972FF1A]"
                  for="bathrooms1"
                  >1</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="bathrooms2" id="bathrooms2" />
                <label
                  class="rounded-xl w-8 h-8 flex items-center text-[#1D4265] justify-center bg-[#2972FF1A]"
                  for="bathrooms2"
                  >2</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="bathrooms3" id="bathrooms3" />
                <label
                  class="rounded-xl w-8 h-8 flex items-center text-[#1D4265] justify-center bg-[#2972FF1A]"
                  for="bathrooms3"
                  >3</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="bathrooms4" id="bathrooms4" />
                <label
                  class="rounded-xl w-8 h-8 flex items-center text-[#1D4265] justify-center bg-[#2972FF1A]"
                  for="bathrooms4"
                  >4</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="bathrooms+5" id="bathrooms+5" />
                <label
                  class="rounded-xl w-8 h-8 flex items-center text-[#1D4265] justify-center bg-[#2972FF1A]"
                  for="bathrooms+5"
                  >+5</label
                >
              </div>
            </div>
          </div>

          <!-- Finishing -->
          <div class="py-4 px-6 font-medium border-b border-[#D9D9D9]">
            <div class="flex items-center justify-between">
              <p class="text-[#1D4265] text-[15px]">Finishing</p>
              <button class="text-[#1563DF] text-[10px]">Reset</button>
            </div>
            <div class="mt-3 manrope flex gap-x-2.5 gap-y-4 flex-wrap text-xs">
              <div class="filter-input">
                <input type="checkbox" name="notFinished" id="notFinished" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="notFinished"
                  >Not Finished</label
                >
              </div>
              <div class="filter-input">
                <input
                  checked
                  type="checkbox"
                  name="semiFinished"
                  id="semiFinished"
                />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="semiFinished"
                  >Semi-Finished</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="finished" id="finished" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="finished"
                  >Finished</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="furnished" id="furnished" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="furnished"
                  >Furnished</label
                >
              </div>
            </div>
          </div>

          <!-- Delivery in -->
          <div class="py-4 px-6 font-medium border-b border-[#D9D9D9]">
            <div class="flex items-center justify-between">
              <p class="text-[#1D4265] text-[15px]">Delivery in</p>
              <button class="text-[#1563DF] text-[10px]">Reset</button>
            </div>
            <div class="mt-3 manrope flex gap-x-2.5 gap-y-4 flex-wrap text-xs">
              <div class="filter-input">
                <input type="checkbox" name="readyToMove" id="readyToMove" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="readyToMove"
                  >Ready To Move</label
                >
              </div>
              <div class="filter-input">
                <input checked type="checkbox" name="2025" id="2025" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="2025"
                  >2025</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="2026" id="2026" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="2026"
                  >2026</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="2027" id="2027" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="2027"
                  >2027</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="2028" id="2028" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="2028"
                  >2028</label
                >
              </div>
              <div class="filter-input">
                <input type="checkbox" name="+2029" id="+2029" />
                <label
                  class="block rounded-full py-2 px-4 leading-4 border border-solid border-[#92929226] bg-[#FAFAFA] text-[#121212]"
                  for="+2029"
                  >+2029</label
                >
              </div>
            </div>
          </div>

          <!-- Price Range -->
          <div class="py-4 px-6 font-medium border-b border-[#D9D9D9]">
            <div class="flex items-center justify-between">
              <p class="text-[#1D4265] text-[15px]">Price Range</p>
              <button class="text-[#1563DF] text-[10px]">Reset</button>
            </div>
            <p class="mt-4 mb-2 text-sm manrope font-semibold text-[#161E2D]">
              <span>Price:</span>
              <span
                data-unit="EGP"
                class="current-sideSmFilterPrice-range"
              ></span>
            </p>
            <div class="range-slider" id="range_sideSmFilterPrice_slider">
              <input
                type="range"
                class="range-slider__input"
                id="range_sideSmFilterPrice_low"
                min="0"
                max="10000"
                step="100"
                value="0"
                oninput="updateRangeSlider('sideSmFilterPrice')"
              />
              <input
                type="range"
                class="range-slider__input"
                id="range_sideSmFilterPrice_high"
                min="0"
                max="10000"
                step="100"
                value="10000"
                oninput="updateRangeSlider('sideSmFilterPrice')"
              />
            </div>
          </div>

          <!-- Unit Area -->
          <div class="py-4 px-6 font-medium border-b border-[#D9D9D9]">
            <div class="flex items-center justify-between">
              <p class="text-[#1D4265] text-[15px]">Unit Area</p>
              <button class="text-[#1563DF] text-[10px]">Reset</button>
            </div>
            <p class="mt-4 mb-2 text-sm manrope font-semibold text-[#161E2D]">
              <span>Area:</span>
              <span
                data-unit="SqFt"
                class="current-sideSmFilterArea-range"
              ></span>
            </p>
            <div class="range-slider" id="range_sideSmFilterArea_slider">
              <input
                type="range"
                class="range-slider__input"
                id="range_sideSmFilterArea_low"
                min="0"
                max="10000"
                step="100"
                value="0"
                oninput="updateRangeSlider('sideSmFilterArea')"
              />
              <input
                type="range"
                class="range-slider__input"
                id="range_sideSmFilterArea_high"
                min="0"
                max="10000"
                step="100"
                value="10000"
                oninput="updateRangeSlider('sideSmFilterArea')"
              />
            </div>
          </div>

          <!-- Payment Plan & Installment Years -->
          <div class="py-4 px-6 font-medium border-b border-[#D9D9D9]">
            <div class="flex items-center justify-between">
              <p class="text-[#1D4265] text-[15px]">Payment Plan</p>
              <button class="text-[#1563DF] text-[10px]">Reset</button>
            </div>
            <div class="mt-3 manrope grid grid-cols-2 gap-4 text-xs">
              <input
                type="text"
                class="placeholder-white text-center bg-[#D9D9D9] rounded-xl outline-none p-3"
                placeholder="Down Payment"
              />
              <input
                type="text"
                class="placeholder-white text-center bg-[#D9D9D9] rounded-xl outline-none p-3"
                placeholder="Monthly Amount"
              />
            </div>

            <div class="mt-8">
              <p class="text-[#1D4265] text-[15px]">Installment Years</p>
              <div class="mt-3 manrope flex gap-4 flex-wrap text-sm">
                <div class="filter-input">
                  <input type="checkbox" name="year1" id="year1" />
                  <label
                    class="rounded-xl w-8 h-8 flex items-center text-[#1D4265] justify-center bg-[#2972FF1A]"
                    for="year1"
                    >1</label
                  >
                </div>
                <div class="filter-input">
                  <input type="checkbox" name="year2" id="year2" />
                  <label
                    class="rounded-xl w-8 h-8 flex items-center text-[#1D4265] justify-center bg-[#2972FF1A]"
                    for="year2"
                    >2</label
                  >
                </div>
                <div class="filter-input">
                  <input type="checkbox" name="year3" id="year3" />
                  <label
                    class="rounded-xl w-8 h-8 flex items-center text-[#1D4265] justify-center bg-[#2972FF1A]"
                    for="year3"
                    >3</label
                  >
                </div>
                <div class="filter-input">
                  <input type="checkbox" name="year4" id="year4" />
                  <label
                    class="rounded-xl w-8 h-8 flex items-center text-[#1D4265] justify-center bg-[#2972FF1A]"
                    for="year4"
                    >4</label
                  >
                </div>
                <div class="filter-input">
                  <input type="checkbox" name="year5" id="year5" />
                  <label
                    class="rounded-xl w-8 h-8 flex items-center text-[#1D4265] justify-center bg-[#2972FF1A]"
                    for="year5"
                    >5</label
                  >
                </div>
                <div class="filter-input">
                  <input type="checkbox" name="year+6" id="year+6" />
                  <label
                    class="rounded-xl w-8 h-8 flex items-center text-[#1D4265] justify-center bg-[#2972FF1A]"
                    for="year+6"
                    >+6</label
                  >
                </div>
              </div>
            </div>
          </div>

          <!-- Amentities -->
          <div class="pt-4 pb-10 px-6">
            <div class="flex items-center justify-between font-medium">
              <p class="text-[#1D4265] text-[15px]">Amentities</p>
              <button class="text-[#1563DF] text-[10px]">Reset</button>
            </div>
            <div
              class="mt-3 manrope grid grid-cols-2 gap-4 text-sm text-[#161E2D]"
            >
              <div class="filter-checkbox">
                <input
                  checked
                  type="checkbox"
                  name="airCondition"
                  id="airCondition"
                />
                <label class="block relative ps-7" for="airCondition"
                  >Air Condition</label
                >
              </div>
              <div class="filter-checkbox">
                <input checked type="checkbox" name="cableTV" id="cableTV" />
                <label class="block relative ps-7" for="cableTV"
                  >Cable TV</label
                >
              </div>
              <div class="filter-checkbox">
                <input type="checkbox" name="fireplace1" id="fireplace1" />
                <label class="block relative ps-7" for="fireplace1"
                  >Fireplace 1</label
                >
              </div>
              <div class="filter-checkbox">
                <input type="checkbox" name="fireplace2" id="fireplace2" />
                <label class="block relative ps-7" for="fireplace2"
                  >Fireplace 2</label
                >
              </div>
              <div class="filter-checkbox">
                <input type="checkbox" name="fireplace3" id="fireplace3" />
                <label class="block relative ps-7" for="fireplace3"
                  >Fireplace 3</label
                >
              </div>
              <div class="filter-checkbox">
                <input type="checkbox" name="fireplace4" id="fireplace4" />
                <label class="block relative ps-7" for="fireplace4"
                  >Fireplace 4</label
                >
              </div>
            </div>
          </div>
        </div>

        <!-- Search Bar -->
        <div
          id="searchBar"
          class="bg-[#FFFFFF8A] fixed bottom-0 max-h-0 w-full"
          style="
            transition: max-height 0.3s ease-in-out;
            backdrop-filter: blur(1px);
          "
        >
          <div
            class="bg-white h-full mt-[122px] shadow-[0px_-2px_4px_0px_#00000040] rounded-t-[35px] py-5 flex flex-col gap-4"
          >
            <div class="px-4">
              <div
                class="flex items-center gap-2 h-10 px-[14px] py-1 bg-[#F5F5F5] rounded-[68px]"
              >
                <span
                  class="material-symbols-rounded shrink-0 text-[#838383] text-base"
                  >search</span
                >
                <input
                  id="searchInput"
                  type="text"
                  placeholder="Search here"
                  class="w-full h-full outline-none text-xs font-normal bg-inherit placeholder-[#838383]"
                />
              </div>
            </div>
            <div
              class="h-[calc(100%-240px)] overflow-y-auto px-4 manrope text-[#161E2D] text-sm font-semibold"
            >
              <p
                onclick="toggleSearchBar('close')"
                class="py-2 px-2 w-fit search-item hover:text-[#1563DF]"
              >
                Property Half Map Grid
              </p>
              <p
                onclick="toggleSearchBar('close')"
                class="py-2 px-2 w-fit search-item hover:text-[#1563DF]"
              >
                Cozy Cottage
              </p>
              <p
                onclick="toggleSearchBar('close')"
                class="py-2 px-2 w-fit search-item hover:text-[#1563DF]"
              >
                Luxury Villa
              </p>
              <p
                onclick="toggleSearchBar('close')"
                class="py-2 px-2 w-fit search-item hover:text-[#1563DF]"
              >
                Downtown Apartment
              </p>
            </div>
          </div>
        </div>
        <div
          class="relative z-[1] flex w-full gap-3 bg-white manrope rounded-ss-3xl text-xs font-semibold rounded-se-3xl pt-3 pb-4 px-6 border border-solid border-[#99999933]"
        >
          <button
            class="w-full bg-[#388DEB] rounded-3xl p-3 text-white leading-tight"
          >
            Show 1235 Results
          </button>
          <button
            class="px-8 py-3 border border-solid border-[#388DEB] text-[#388DEB] rounded-3xl leading-tight"
          >
            Reset
          </button>
        </div>
      </div>


<!-- Overlay -->
<div id="overlay" class="fixed inset-0 bg-black bg-opacity-40 z-40 hidden"></div>

<!-- Wrapper -->
<div
  id="deliveryfilter"
  class="fixed bottom-0 left-0 right-0 z-50 hidden overflow-hidden transition-all duration-300 ease-in-out"
  style="max-height: 0px;"
>
  <!-- Bottom Sheet -->
  <div
    id="bottomSheet"
    class="md:max-w-[388px] bg-white rounded-t-[40px] shadow-lg z-50 p-4 transition-transform duration-300 translate-y-0"
  >
    <!-- Drag Handle -->
    <div class="flex justify-center mb-4 cursor-pointer" id="dragHandle">
      <div class="h-1 w-12 bg-black rounded-full"></div>
    </div>

    <!-- Title -->
    <h2 class="text-center text-lg font-semibold text-[#1D4265] mb-4">Delivery</h2>

    <!-- Options -->
    <div class="space-y-3">
      <div class="flex items-center justify-between bg-[#D9D9D9] rounded-xl px-4 py-1">
        <span class="text-gray-800 font-medium">2027</span>
        <input type="checkbox"
               class="w-5 h-5 rounded-full appearance-none border-2 border-[#C2C2C2] checked:bg-[#C2C2C2] checked:border-[#C2C2C2]" />
      </div>
      <!-- Repeat Options ... -->
         <div class="flex items-center justify-between bg-[#D9D9D9] rounded-xl px-4 py-1">
        <span class="text-gray-800 font-medium">2027</span>
        <input type="checkbox"
               class="w-5 h-5 rounded-full appearance-none border-2 border-[#C2C2C2] checked:bg-[#C2C2C2] checked:border-[#C2C2C2]" />
      </div>  <div class="flex items-center justify-between bg-[#D9D9D9] rounded-xl px-4 py-1">
        <span class="text-gray-800 font-medium">2027</span>
        <input type="checkbox"
               class="w-5 h-5 rounded-full appearance-none border-2 border-[#C2C2C2] checked:bg-[#C2C2C2] checked:border-[#C2C2C2]" />
      </div>
    </div>

    <!-- Apply Button -->
    <div class="mt-6 w-full m-auto flex justify-center">
      <button class="w-[100px] bg-[#1D4265] text-white py-1 rounded-full font-medium">Apply</button>
    </div>
  </div>
</div>




      <!-- Property Types Filter -->
       <div id="overlaytow" class="fixed inset-0 bg-black bg-opacity-40 z-40 hidden"></div>
   <div
     id="propertyfilter"
  class="fixed bottom-0 left-0 right-0 z-50 hidden overflow-hidden transition-all duration-300 ease-in-out"
  style="max-height: 0px;">

  <!-- Bottom Sheet -->
  <div id="bottomSheet"
  class="md:max-w-[388px] bg-white rounded-t-[40px] shadow-lg z-50 p-4 transition-transform duration-300 translate-y-0">

    <!-- Drag Handle -->
    <div class="flex justify-center mb-4 cursor-pointer" id="dragHandle">
      <div class="h-1 w-12 bg-black rounded-full"></div>
    </div>

    <!-- Title -->
    <h2 class="text-center text-lg font-semibold text-[#1D4265] mb-4">Property Types</h2>

    <!-- Property Options -->
    <div class="space-y-3">
      <div class="flex items-center justify-between bg-[#D9D9D9] rounded-xl px-4 py-2">
        <div class="flex items-center space-x-3">
          <img src="./images/4cb71df8306c59a57f64e4e23660dbb5d44b3188.png" class="w-6 h-6" />
          <span class="text-gray-800 font-medium">Apartment</span>
        </div>
<input type="checkbox" class="w-5 h-5 rounded-full appearance-none border-2 border-[#C2C2C2] checked:bg-[#C2C2C2] checked:border-[#C2C2C2]" />

      </div>
      <!-- تكرار -->
      <div class="flex items-center justify-between bg-[#D9D9D9] rounded-xl px-4 py-2">
        <div class="flex items-center space-x-3">
          <img src="./images/4cb71df8306c59a57f64e4e23660dbb5d44b3188.png" class="w-6 h-6" />
          <span class="text-gray-800 font-medium">Apartment</span>
        </div>
        <input type="checkbox" class="w-5 h-5 rounded-full appearance-none border-2 border-[#C2C2C2] checked:bg-[#C2C2C2] checked:border-[#C2C2C2]" />

      </div>
      <div class="flex items-center justify-between bg-[#D9D9D9] rounded-xl px-4 py-2">
        <div class="flex items-center space-x-3">
          <img src="./images/4cb71df8306c59a57f64e4e23660dbb5d44b3188.png" class="w-6 h-6" />
          <span class="text-gray-800 font-medium">Apartment</span>
        </div>
<input type="checkbox" class="w-5 h-5 rounded-full appearance-none border-2 border-[#C2C2C2] checked:bg-[#C2C2C2] checked:border-[#C2C2C2]" />
      </div>
    </div>

    <!-- Apply Button -->
    <div class="mt-6 w-full m-auto flex justify-center">
      <button class="w-[100px]  bg-[#1D4265] text-white py-1 rounded-full font-medium">Apply</button>
    </div>
  </div>
    </div>



      <!-- Price RangeFilter -->
       <div id="overlaythree" class="fixed inset-0 bg-black bg-opacity-40 z-40 hidden"></div>
       <div
     id="pricefilter" 
class="fixed bottom-0 left-0 right-0 z-50 hidden overflow-hidden transition-all duration-300 ease-in-out"
  style="max-height: 0px;">

  <!-- Bottom Sheet -->
  <div
    id="bottomSheet"
    class="md:max-w-[388px] bg-white rounded-t-[40px] shadow-lg z-50 p-4 transition-transform duration-300 translate-y-0"
  >

    <!-- Drag Handle -->
    <div class="flex justify-center mb-4 cursor-pointer" id="dragHandle">
      <div class="h-1 w-12 bg-black rounded-full"></div>
    </div>

    <!-- Title -->
    <h2 class="text-center text-lg font-semibold text-[#1D4265] mb-4">Price Range</h2>

    <!-- Property Options -->

    <div class=" m-auto w-full ">
  <span class="text-[#1D4265] flex  justify-center items-center text-[12px] w-full m-auto ">Enter the minimum and maximum budget</span>

          <div class="py-4 px-6 font-medium border-b border-[#D9D9D9]">
            <p class="mt-4 mb-2 text-sm manrope font-semibold text-[#161E2D]">
              <span>Area:</span>
              <span
                data-unit="SqFt"
                class="current-sideSmFilterArea-range"
              ></span>
            </p>
            <div class="range-slider" id="range_sideSmFilterArea_slider">
              <input
                type="range"
                class="range-slider__input"
                id="range_sideSmFilterArea_low"
                min="0"
                max="10000"
                step="100"
                value="0"
                oninput="updateRangeSlider('sideSmFilterArea')"
              />
              <input
                type="range"
                class="range-slider__input"
                id="range_sideSmFilterArea_high"
                min="0"
                max="10000"
                step="100"
                value="10000"
                oninput="updateRangeSlider('sideSmFilterArea')"
              />
            </div>
          </div>

          <!-- Payment Plan & Installment Years -->
          <div class="py-4 px-6 font-medium border-b border-[#D9D9D9]">
            <div class="flex items-center justify-between">
              <p class="text-[#1D4265] text-[15px]">Payment Plan</p>
              <button class="text-[#1563DF] text-[10px]">Reset</button>
            </div>
            <div class="mt-3 manrope grid grid-cols-2 gap-4 text-xs">
              <input
                type="text"
                class="placeholder-black text-center bg-[#D9D9D9] rounded-xl outline-none p-3"
                placeholder="0 EGP"
              />
              <input
                type="text"
                class="placeholder-black text-center bg-[#D9D9D9] rounded-xl outline-none p-3"
                placeholder="1000,0 EGP"
              />
            </div>

      
          </div>
    </div>

    <!-- Apply Button -->
    <div class="mt-6 w-full m-auto flex justify-center">
      <button class="w-[100px]  bg-[#1D4265] text-white py-1 rounded-full font-medium">Apply</button>
    </div>
  </div>
    </div>
    <script>
      mapboxgl.accessToken =
        "pk.eyJ1Ijoia2FyaW1ha2wiLCJhIjoiY21icDBhampvMXNiMTJ2cXg4ZHRwcGJ4NSJ9.sEZaAXS8epoHMjPfclOh2g";

      const styleStreets = "mapbox://styles/mapbox/streets-v12";
      const styleSatellite = "mapbox://styles/mapbox/satellite-streets-v12";

let markers = [];
let currentStyle = styleStreets;
const initialCenter = [31.2, 30.05];
const initialZoom = 7;

      const map = new mapboxgl.Map({
        container: "map",
        style: currentStyle,
        center: [31.2, 30.05],
        zoom: 1,
      });
      map.on("load", () => {
  // بعد 2 ثانية (2000 مللي ثانية)
  setTimeout(() => {
    map.flyTo({
      center: [31.2, 30.05],
      zoom: 7, // 👈 الزوم اللي تحب توصله تلقائيًا
      speed: 1.5, // سرعة التحرك
      curve: 1.2, // انحناء الحركة
      essential: true
    });
  }, 200);
});


      function createCustomProjectMarker(name) {
        const el = document.createElement("div");
        el.style.width = "20px";
        el.style.height = "30px";
        el.style.backgroundColor = "#155e9a";
        el.style.border = "2px solid white";
        el.style.borderRadius = "3px";
        el.style.boxShadow = "0 0 5px rgba(0,0,0,0.5)";
        el.style.position = "relative";
        el.style.display = "flex";
        el.style.flexWrap = "wrap";
        el.style.alignContent = "flex-start";
        el.style.padding = "2px";

        // إضافة نوافذ صغيرة (مربعات بيضاء)
        for (let i = 0; i < 6; i++) {
          const windowDiv = document.createElement("div");
          windowDiv.style.width = "4px";
          windowDiv.style.height = "4px";
          windowDiv.style.margin = "1px";
          windowDiv.style.backgroundColor = "white";
          el.appendChild(windowDiv);
        }

        // اسم المشروع فوق المبنى
        const label = document.createElement("div");
        label.textContent = name;
        label.style.position = "absolute";
        label.style.top = "-20px";
        label.style.left = "50%";
        label.style.transform = "translateX(-50%)";
        label.style.backgroundColor = "white";
        label.style.color = "#000";
        label.style.padding = "2px 6px";
        label.style.borderRadius = "6px";
        label.style.fontSize = "10px";
        label.style.fontWeight = "bold";
        label.style.fontFamily = "Arial, sans-serif";
        label.style.boxShadow = "0 2px 6px rgba(0,0,0,0.2)";
        label.style.whiteSpace = "nowrap";
        label.style.pointerEvents = "none";

        el.appendChild(label);

        return el;
      }

  function addProjectsMarkers() {
  fetch("projects.geojson")
    .then((res) => res.json())
    .then((data) => {
          console.log("Projects Loaded:", data);
      data.features.forEach((feat) => {
        const [lng, lat] = feat.geometry.coordinates;

        const marker = new mapboxgl.Marker()
  .setLngLat([lng, lat])
  .addTo(map);

// ✅ أضف الزووم هنا قبل فتح المودال:
marker.getElement().addEventListener("click", () => {
  // zoom in and move to marker location
  map.flyTo({
    center: [lng, lat],
    zoom: 14,
    speed: 1.2,
    curve: 1,
    essential: true
  });

  // فتح المودال
  openModal({
    image: feat.properties.image,
    price: feat.properties.price,
    locationText: feat.properties.locationText,
    date: feat.properties.date,
    code: feat.properties.code,
    type: feat.properties.type,
    size: feat.properties.size,
    bedrooms: feat.properties.bedrooms,
    delivery: feat.properties.delivery,
    project: feat.properties.name,
    developer: feat.properties.developer
          });
        });

        // إنشاء التسمية
        const label = document.createElement("div");
        label.className = "marker-label";
        label.textContent = feat.properties.name;

        // إضافة التسمية فوق الماركر
        new mapboxgl.Marker(label)
          .setLngLat([lng, lat])
          .setOffset([0, -45])
          .addTo(map);
      });
    });
}

function addAreaMarkers() {
  fetch("areas.geojson")
    .then((res) => res.json())
    .then((data) => {
      data.features.forEach((feat) => {
        const coords = feat.geometry.coordinates?.[0];

        if (!Array.isArray(coords) || coords.length === 0) {
          console.warn("Skipping invalid area geometry:", feat);
          return;
        }

        // حساب المركز
        const center = coords
          .reduce((acc, pt) => {
            if (!Array.isArray(pt) || pt.length < 2) return acc;
            return [acc[0] + pt[0], acc[1] + pt[1]];
          }, [0, 0])
          .map((v) => v / coords.length);

        if (isNaN(center[0]) || isNaN(center[1])) {
          console.error("Calculated center is invalid (NaN)", center, feat);
          return;
        }

        const label = document.createElement("div");
        label.className = "marker-label";
        label.textContent = feat.properties.shapeName;

        const marker = new mapboxgl.Marker(label).setLngLat(center).addTo(map);
        markers.push(marker);
      });
    });
}

      function removeMarkers() {
        markers.forEach((m) => m.remove());
        markers = [];
      }

      function addLayersAndMarkers() {
        removeMarkers();

        if (currentStyle === styleStreets) {
          if (!map.getSource("areas")) {
            map.addSource("areas", {
              type: "geojson",
              data: "areas.geojson",
            });
          }

          if (!map.getLayer("areas-fill")) {
            map.addLayer({
              id: "areas-fill",
              type: "fill",
              source: "areas",
              paint: {
                "fill-color": "rgb(177,200,216)",
                "fill-opacity": 0.4,
              },
            });
          }

          if (!map.getLayer("areas-border")) {
            map.addLayer({
              id: "areas-border",
              type: "line",
              source: "areas",
              paint: {
                "line-color": "rgb(100,120,130)",
                "line-width": 2,
              },
            });
          }

          addAreaMarkers();
        } else if (currentStyle === styleSatellite) {
          if (map.getLayer("areas-fill")) map.removeLayer("areas-fill");
          if (map.getLayer("areas-border")) map.removeLayer("areas-border");
          if (map.getSource("areas")) map.removeSource("areas");

          if (!map.getSource("projects")) {
            map.addSource("projects", {
              type: "geojson",
              data: "projects.geojson",
            });
          }

          addProjectsMarkers();
        }
      }

      map.on("style.load", () => {
        addLayersAndMarkers();
      });

      function updateStyleByZoom() {
        const zoom = map.getZoom();
        if (zoom >= 10 && currentStyle !== styleSatellite) {
          currentStyle = styleSatellite;
          map.setStyle(currentStyle);
        } else if (zoom < 10 && currentStyle !== styleStreets) {
          currentStyle = styleStreets;
          map.setStyle(currentStyle);
        }
      }

      map.on("zoomend", updateStyleByZoom);

function openModal(unitData) {
  document.getElementById("unitModal").classList.remove("hidden");

  // تحديث صورة الوحدة
  document.getElementById("unitImage").src = unitData.image || './images/compound.jpeg';

  document.getElementById("unitPrice").textContent = unitData.price || "غير متوفر";
  document.getElementById("unitLocation").textContent = unitData.locationText || "غير متوفر";
  document.getElementById("unitDate").textContent = unitData.date || "";
  document.getElementById("unitCode").textContent = unitData.code || "";
  document.getElementById("unitType").textContent = unitData.type || "";
  document.getElementById("unitSize").textContent = unitData.size || "";
  document.getElementById("unitBedrooms").textContent = unitData.bedrooms || "";
  document.getElementById("unitDelivery").textContent = unitData.delivery || "";
  document.getElementById("unitProject").textContent = unitData.project || "";
  document.getElementById("unitDeveloper").textContent = unitData.developer || "";
}


function closeModal() {
  document.getElementById("unitModal").classList.add("hidden");
}
      function handleShareClick(event) {
        event.stopPropagation();

        const isMobile = window.innerWidth <= 768;
        const menu = event.currentTarget.querySelector(".share-menu");

        if (isMobile) {
          // Toggle share menu visibility
          menu.classList.toggle("invisible");
          menu.classList.toggle("opacity-0");
        } else {
          // Just copy the link on desktop
          copyLink();
        }
      }

    
      // Close the share menu if clicking outside
      document.addEventListener("click", () => {
        document.querySelectorAll(".share-menu").forEach((menu) => {
          menu.classList.add("invisible", "opacity-0");
        });
      });

      const searchInput = document.getElementById("searchInput");
      const items = document.querySelectorAll(".search-item");

      searchInput.addEventListener("input", function () {
        const searchValue = this.value.toLowerCase();

        items.forEach((item) => {
          const text = item.textContent.toLowerCase();
          if (text.includes(searchValue)) {
            item.style.display = "block";
          } else {
            item.style.display = "none";
          }
        });
      });
  document.getElementById('overlay').addEventListener('click', function () {
    deliveryFilter('close');
  });
    document.getElementById("overlaytow").addEventListener("click", function () {
    propertyFilter("close");
  });
   document.getElementById("overlaythree").addEventListener("click", function () {
    priceFilter("close");
  });
  
document.querySelector('.reset-btn').addEventListener('click', () => {
  map.flyTo({
    center: initialCenter,
    zoom: initialZoom,
    speed: 1.2,
    curve: 1,
    essential: true
  });
});
const projects = [
  { name: "O West Orascom", logo: "./images/brand1.svg", coordinates: [31.02, 30.05] },
  { name: "Badya", logo: "./images/7325a8a8999c8970749f86fc6b13087cf1843308.png", coordinates: [30.9, 30.1] },
  { name: "City Gate", logo: "./images/7325a8a8999c8970749f86fc6b13087cf1843308.png", coordinates: [31.1, 30.08] },
  { name: "ZED East", logo: "./images/7325a8a8999c8970749f86fc6b13087cf1843308.png", coordinates: [31.05, 30.07] },
];
const input = document.getElementById("searchInput");
const resultsBox = document.getElementById("searchResults");

function renderResults(filteredProjects) {
  resultsBox.innerHTML = "";

  if (filteredProjects.length === 0) {
    resultsBox.classList.add("hidden");
    return;
  }

  filteredProjects.forEach((project) => {
    const item = document.createElement("div");
    item.className = "search-result-item";

    item.innerHTML = `
      <img src="${project.logo}" alt="${project.name}" />
      <span>${project.name}</span>
    `;

    item.addEventListener("click", () => {
      map.flyTo({ center: project.coordinates, zoom: 14 });
      resultsBox.classList.add("hidden");
      input.value = project.name;
    });

    resultsBox.appendChild(item);
  });

  resultsBox.classList.remove("hidden");
}

// ✅ لما المستخدم يبدأ يكتب
input.addEventListener("input", () => {
  const value = input.value.trim().toLowerCase();

  if (!value) {
    renderResults(projects); // إظهار كل المشاريع بشكل افتراضي
    return;
  }

  const filtered = projects.filter((p) =>
    p.name.toLowerCase().includes(value)
  );

  renderResults(filtered);
});

// ✅ لما المستخدم يضغط على خانة البحث (focus)
input.addEventListener("focus", () => {
  renderResults(projects); // إظهار كل المشاريع أول ما يضغط
});


    </script>
  </body>
</html>
